<div class="form-wrapper">
  <form [formGroup]="signupForm" (ngSubmit)="onSubmit()">
    <fieldset>

      <div class="form-header">
        <h1>StudyHub</h1>
        <p>Create your account</p>
      </div>


      @if (errorService.message()) {
      <p class="firebase-error-msg error">{{ errorService.message() }}</p>
      }


      @if (successMessage) {
      <p class="firebase-success-msg success">{{ successMessage }}</p>
      }


      <div class="form-group">
        <label for="fullName">Full Name</label>
        <input id="fullName" type="text" placeholder="Enter your full name" formControlName="fullName"
          [class.input-error]="fullName?.invalid && (fullName?.dirty || fullName?.touched)"
          [class.input-valid]="fullName?.valid && (fullName?.dirty || fullName?.touched)" />
        @if (fullName?.invalid && (fullName?.dirty || fullName?.touched)) {
        <p class="error-msg">Full name is required.</p>
        }
      </div>


      <div class="form-group">
        <label for="email">Email</label>
        <input id="email" type="email" placeholder="Enter your email" formControlName="email"
          [class.input-error]="email?.invalid && (email?.dirty || email?.touched)"
          [class.input-valid]="email?.valid && (email?.dirty || email?.touched)" />
        @if (email?.invalid && (email?.dirty || email?.touched)) {
        <p class="error-msg">
          @if (email?.errors?.['required']) { Email is required. }
          @if (email?.errors?.['email']) { Invalid email format. }
        </p>
        }
      </div>


      <div class="form-group">
        <label for="password">Password</label>
        <div class="password-wrapper">
          <input id="password" [type]="showPassword ? 'text' : 'password'" placeholder="Create a password"
            formControlName="password" [class.input-error]="password?.invalid && (password?.dirty || password?.touched)"
            [class.input-valid]="password?.valid && (password?.dirty || password?.touched)" />
          <span class="password-toggle" (click)="showPassword = !showPassword" title="Toggle password visibility">
            <i class="fa" [ngClass]="showPassword ? 'fa-eye-slash' : 'fa-eye'"></i>
          </span>
        </div>
        @if (password?.invalid && (password?.dirty || password?.touched)) {
        <p class="error-msg">
          @if (password?.errors?.['required']) { Password is required. }
          @if (password?.errors?.['minlength']) { At least 6 characters required. }
        </p>
        }
      </div>


      <div class="form-group">
        <label for="confirmPassword">Confirm Password</label>
        <div class="password-wrapper">
          <input id="confirmPassword" [type]="showPassword ? 'text' : 'password'" placeholder="Confirm your password"
            formControlName="confirmPassword"
            [class.input-error]="signupForm.errors?.['passwordMismatch'] && (confirmPassword?.dirty || confirmPassword?.touched)"
            [class.input-valid]="!signupForm.errors?.['passwordMismatch'] && confirmPassword?.valid && (confirmPassword?.dirty || confirmPassword?.touched)" />
          <span class="password-toggle" (click)="showPassword = !showPassword" title="Toggle password visibility">
            <i class="fa" [ngClass]="showPassword ? 'fa-eye-slash' : 'fa-eye'"></i>
          </span>
        </div>
        @if (signupForm.errors?.['passwordMismatch'] && (confirmPassword?.dirty || confirmPassword?.touched)) {
        <p class="error-msg">Passwords do not match.</p>
        }
      </div>


      <div class="form-actions">
        <button type="submit" [disabled]="signupForm.invalid || isSubmitting">
          {{ isSubmitting ? 'Registering...' : 'Create Account' }}
        </button>
      </div>


      <div class="form-footer">
        <p>
          Already have an account?
          <a routerLink="/login">Sign in</a>
        </p>
        <p>
          <a routerLink="/">‚Üê Back to home</a>
        </p>
      </div>
    </fieldset>
  </form>
</div>