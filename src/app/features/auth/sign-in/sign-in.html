<div class="form-wrapper">
    <div class="glass-bubble" style="top: 12%; left: 10%;"></div>
    <div class="glass-bubble" style="top: 25%; right: 12%;"></div>
    <div class="glass-bubble" style="bottom: 20%; left: 16%;"></div>
    <div class="glass-bubble" style="bottom: 2%; right: 29%;"></div>

    <form [formGroup]="signInForm" (ngSubmit)="onSubmit()">
        <fieldset>
            <div class="form-header">
                <h1>StudyHub</h1>
                <p>Welcome back</p>
                <p style="font-size: 0.9rem; color: #7e8194; font-weight: 500;">
                    Sign in to your account to continue your learning journey
                </p>
            </div>

            <!-- removed inline errorService block; errors now show via global toast modal -->

            <div class="form-group">
                <label for="email">Email</label>
                <input id="email" type="email" placeholder="Enter your email" formControlName="email"
                    [class.input-error]="email?.invalid && (email?.touched || email?.dirty)"
                    [class.input-valid]="email?.valid && (email?.touched || email?.dirty)" />
                @if (email?.invalid && (email?.touched || email?.dirty)) {
                <p class="error-msg">
                    @if (email?.errors?.['required']) { Email is required. }
                    @if (email?.errors?.['email']) { Invalid email format. }
                </p>
                }
            </div>

            <div class="form-group">
                <label for="password">Password</label>
                <div class="password-wrapper">
                    <input id="password" [type]="showPassword ? 'text' : 'password'" placeholder="Enter your password"
                        formControlName="password"
                        [class.input-error]="password?.invalid && (password?.touched || password?.dirty)"
                        [class.input-valid]="password?.valid && (password?.touched || password?.dirty)" />
                    <span class="password-toggle" (click)="showPassword = !showPassword"
                        title="Toggle password visibility">
                        <i class="fa" [ngClass]="showPassword ? 'fa-eye-slash' : 'fa-eye'"></i>
                    </span>
                </div>

                @if (password?.invalid && (password?.touched || password?.dirty)) {
                <p class="error-msg">
                    @if (password?.errors?.['required']) { Password is required. }
                    @if (password?.errors?.['minlength']) { At least 6 characters required. }
                </p>
                }
            </div>

            <div class="form-actions">
                <button type="submit" [disabled]="signInForm.invalid || isSubmitting">
                    {{ isSubmitting ? 'Signing in...' : 'Sign In' }}
                </button>
            </div>

            <div class="form-footer">
                <p>Don’t have an account? <a routerLink="/sign-up">Sign up</a></p>
                <p><a routerLink="/">← Back to home</a></p>
            </div>
        </fieldset>
    </form>
</div>