<div class="page-card">

    <div class="card-header">
        <div class="header-row">
            <h2 class="page-title">{{ page.title || 'Untitled' }}</h2>

            <div class="card-owner-actions" *ngIf="page.isPublic && page.ownerId === currentUserId">
                <button class="btn icon-btn" (click)="handleEdit()">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" width="1em"
                        height="1em">
                        <path
                            d="M17.414 2.586a2 2 0 0 1 0 2.828l-1.121 1.121-2.828-2.828 1.121-1.121a2 2 0 0 1 2.828 0zM2 13.586V17h3.414l9.193-9.193-2.828-2.828L2 13.586z" />
                    </svg>
                </button>

                <button class="btn icon-btn" (click)="handleDelete()">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                        stroke-width="2" stroke-linecap="round" stroke-linejoin="round" width="1em" height="1em"
                        aria-hidden="true">
                        <polyline points="3 6 5 6 21 6"></polyline>
                        <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"></path>
                        <path d="M10 11v6"></path>
                        <path d="M14 11v6"></path>
                        <path d="M9 6V4a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v2"></path>
                    </svg>
                </button>
            </div>
        </div>

        <p class="page-description">
            {{
            page.notes
            ? page.notes.length > 150
            ? page.notes.substring(0, 150) + '...'
            : page.notes
            : 'No description available.'
            }}
        </p>
    </div>

    <div class="tags">
        <span class="tag" *ngFor="let tag of (page.syllabus?.slice(0, 3) || [])">
            {{ tag?.text || 'General' }}
        </span>
    </div>

    <div class="card-footer with-date">
        <div class="author">
            <div class="avatar">ðŸ‘¤</div>
            <div class="meta">
                <p class="name">{{ author }}</p>
                <p class="subject">{{ page.subject || 'Unknown Subject' }}</p>
            </div>
        </div>
        <span class="date-text">{{ formatDate(page.createdAt) }}</span>
    </div>

    <div class="card-bottom-row">
        <div class="meta-stats">
            <span class="meta-button likes" [class.clickable]="isLoggedIn" [class.liked]="isLiked"
                [class.disabled]="!isLoggedIn" (click)="handleLikeClick()">
                <i class="fas fa-heart"></i> {{ page.likesCount }}
            </span>

            <a class="meta-button comments clickable" [routerLink]="['/explore', page.id]" [fragment]="'comments'">
                <i class="fas fa-comment-alt"></i> {{ commentCount }}
            </a>
        </div>

        <div class="card-actions">
            <a [routerLink]="['/explore', page.id]" (click)="navigateToPage(page.id)" class="view-btn">
                View Page
            </a>
        </div>
    </div>

</div>