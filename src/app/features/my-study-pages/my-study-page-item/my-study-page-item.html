<div class="card">

    <div class="card-header">
        <div class="badges">
            <span class="badge subject">{{ subject }}</span>
            <span class="status-badge" [ngClass]="{ 'published': isPublic, 'private': !isPublic }">
                {{ visibilityStatus }}
            </span>
        </div>
        <div class="actions">
            <button class="btn view-btn" (click)="navigateToPage(page.id)">View Page</button>
            <button class="btn icon-btn" (click)="handleEdit()">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" width="1.2em"
                    height="1.2em">
                    <path
                        d="M17.414 2.586a2 2 0 0 1 0 2.828l-1.121 1.121-2.828-2.828 1.121-1.121a2 2 0 0 1 2.828 0zM2 13.586V17h3.414l9.193-9.193-2.828-2.828L2 13.586z" />
                </svg>
            </button>
            <button class="btn icon-btn" (click)="handleDelete()">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" width="1.2em" height="1.2rem"
                    aria-hidden="true">
                    <polyline points="3 6 5 6 21 6"></polyline>
                    <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"></path>
                    <path d="M10 11v6"></path>
                    <path d="M14 11v6"></path>
                    <path d="M9 6V4a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v2"></path>
                </svg>
            </button>
        </div>
    </div>

    <h2 class="page-title">{{ page.title }}</h2>

    <p class="page-notes">{{ page.notes | slice: 0:150 }}{{ page.notes.length > 150 ? '...' : '' }}</p>

    <div class="tag-badges">
        <span *ngFor="let tag of tags" class="tag">{{ tag }}</span>
    </div>

    <div class="card-footer">
        <div class="info">
            <span class="likes">
                <i class="fas fa-heart"></i> {{ likes }}
            </span>
            <span class="date">{{ formatDate(page.createdAt) }}</span>
        </div>

        <div class="footer-actions">
            <div class="toggle-container">
                <button class="toggle-switch" [ngClass]="{ 'public': isPublic }" (click)="handleToggleVisibility()"
                    [title]="isPublic ? 'Make Private' : 'Make Public'">
                </button>
                <span class="visibility-emoji">
                    <i [ngClass]="isPublic ? 'fas fa-globe' : 'fas fa-lock'"></i>
                </span>
            </div>
        </div>
    </div>

</div>